#!/bin/bash
set -u

trusted() {
    local name=$1
    docker cp $XAUTHORITY $name:/tmp/.Xauthority
}

untrusted() {
    local name=$1
    tmp1=$(mktemp)
    tmp2=$(mktemp)
    xauth -f ${tmp1} generate $DISPLAY . untrusted timeout 0
    xauth -f ${tmp1} nlist $DISPLAY | sed -e 's/^..../ffff/' | xauth -f ${tmp2} nmerge -

    docker cp ${tmp2} $name:/tmp/.Xauthority
    rm ${tmp1} ${tmp2}
}

"$1" "$2"
